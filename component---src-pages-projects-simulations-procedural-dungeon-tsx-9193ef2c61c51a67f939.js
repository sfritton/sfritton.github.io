/*! For license information please see component---src-pages-projects-simulations-procedural-dungeon-tsx-9193ef2c61c51a67f939.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"2mql":function(e,t,n){"use strict";var r=n("TOwV"),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var h=Object.defineProperty,l=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(p){var i=d(n);i&&i!==p&&e(t,i,r)}var s=l(n);u&&(s=s.concat(u(n)));for(var a=c(t),y=c(n),m=0;m<s.length;++m){var v=s[m];if(!(o[v]||r&&r[v]||y&&y[v]||a&&a[v])){var x=f(n,v);try{h(t,v,x)}catch(g){}}}}return t}},"3Pna":function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),i=n.n(r),o=n("VXBa"),s=n("zLVn");function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var h=n("dI71"),l=n("TOwV"),u=n("2mql"),f=n.n(u);function d(e,t){if(!e){var n=new Error("loadable: "+t);throw n.framesToPop=1,n.name="Invariant Violation",n}}var p=i.a.createContext();var y={initialChunks:{}};var m=function(e){return e};function v(e){var t=e.defaultResolveComponent,n=void 0===t?m:t,r=e.render,o=e.onLoad;function u(e,t){void 0===t&&(t={});var u=function(e){return"function"==typeof e?{requireAsync:e,resolve:function(){},chunkName:function(){}}:e}(e),m={};function v(e){return t.cacheKey?t.cacheKey(e):u.resolve?u.resolve(e):"static"}function x(e,r,i){var o=t.resolveComponent?t.resolveComponent(e,r):n(e);if(t.resolveComponent&&!Object(l.isValidElementType)(o))throw new Error("resolveComponent returned something that is not a React component!");return f()(i,o,{preload:!0}),o}var g,b=function(e){function n(n){var r;return(r=e.call(this,n)||this).state={result:null,error:null,loading:!0,cacheKey:v(n)},d(!n.__chunkExtractor||u.requireSync,"SSR requires `@loadable/babel-plugin`, please install it"),n.__chunkExtractor?(!1===t.ssr||(u.requireAsync(n).catch((function(){return null})),r.loadSync(),n.__chunkExtractor.addChunk(u.chunkName(n))),c(r)):(!1!==t.ssr&&(u.isReady&&u.isReady(n)||u.chunkName&&y.initialChunks[u.chunkName(n)])&&r.loadSync(),r)}Object(h.a)(n,e),n.getDerivedStateFromProps=function(e,t){var n=v(e);return a({},t,{cacheKey:n,loading:t.loading||t.cacheKey!==n})};var i=n.prototype;return i.componentDidMount=function(){this.mounted=!0;var e=this.getCache();e&&"REJECTED"===e.status&&this.setCache(),this.state.loading&&this.loadAsync()},i.componentDidUpdate=function(e,t){t.cacheKey!==this.state.cacheKey&&this.loadAsync()},i.componentWillUnmount=function(){this.mounted=!1},i.safeSetState=function(e,t){this.mounted&&this.setState(e,t)},i.getCacheKey=function(){return v(this.props)},i.getCache=function(){return m[this.getCacheKey()]},i.setCache=function(e){void 0===e&&(e=void 0),m[this.getCacheKey()]=e},i.triggerOnLoad=function(){var e=this;o&&setTimeout((function(){o(e.state.result,e.props)}))},i.loadSync=function(){if(this.state.loading)try{var e=x(u.requireSync(this.props),this.props,w);this.state.result=e,this.state.loading=!1}catch(t){console.error("loadable-components: failed to synchronously load component, which expected to be available",{fileName:u.resolve(this.props),chunkName:u.chunkName(this.props),error:t?t.message:t}),this.state.error=t}},i.loadAsync=function(){var e=this,t=this.resolveAsync();return t.then((function(t){var n=x(t,e.props,{Loadable:w});e.safeSetState({result:n,loading:!1},(function(){return e.triggerOnLoad()}))})).catch((function(t){return e.safeSetState({error:t,loading:!1})})),t},i.resolveAsync=function(){var e=this,t=this.props,n=(t.__chunkExtractor,t.forwardedRef,Object(s.a)(t,["__chunkExtractor","forwardedRef"])),r=this.getCache();return r||((r=u.requireAsync(n)).status="PENDING",this.setCache(r),r.then((function(){r.status="RESOLVED"}),(function(t){console.error("loadable-components: failed to asynchronously load component",{fileName:u.resolve(e.props),chunkName:u.chunkName(e.props),error:t?t.message:t}),r.status="REJECTED"}))),r},i.render=function(){var e=this.props,n=e.forwardedRef,i=e.fallback,o=(e.__chunkExtractor,Object(s.a)(e,["forwardedRef","fallback","__chunkExtractor"])),c=this.state,h=c.error,l=c.loading,u=c.result;if(t.suspense&&"PENDING"===(this.getCache()||this.loadAsync()).status)throw this.loadAsync();if(h)throw h;var f=i||t.fallback||null;return l?f:r({fallback:f,result:u,options:t,props:a({},o,{ref:n})})},n}(i.a.Component),E=(g=b,function(e){return i.a.createElement(p.Consumer,null,(function(t){return i.a.createElement(g,Object.assign({__chunkExtractor:t},e))}))}),w=i.a.forwardRef((function(e,t){return i.a.createElement(E,Object.assign({forwardedRef:t},e))}));return w.preload=function(e){u.requireAsync(e)},w.load=function(e){return u.requireAsync(e)},w}return{loadable:u,lazy:function(e,t){return u(e,a({},t,{suspense:!0}))}}}var x=v({defaultResolveComponent:function(e){return e.__esModule?e.default:e.default||e},render:function(e){var t=e.result,n=e.props;return i.a.createElement(t,n)}}),g=x.loadable,b=x.lazy,E=v({onLoad:function(e,t){e&&t.forwardedRef&&("function"==typeof t.forwardedRef?t.forwardedRef(e):t.forwardedRef.current=e)},render:function(e){var t=e.result,n=e.props;return n.children?n.children(t):null}}),w=E.loadable,k=E.lazy;var S=g;S.lib=w,b.lib=k;var P=S((function(){return Promise.all([n.e(0),n.e(3),n.e(12)]).then(n.bind(null,"Gzlp"))})),C=function(e){return i.a.createElement(P,e)},O=n("KQm4"),D=function(e,t){return(t-e)*Math.random()+e},N=function(e,t){return e+(t-e)*(.5+D(-.25,.25))},M=function(){function e(e,t,n,r,i){this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.exits=[],this.level=0,this.maxLevel=0,this.onPath=!1,this.hasKey=!1,this.isDungeonEntrance=!1,this.isDungeonExit=!1,this.p5=e,this.x1=t,this.x2=n,this.y1=r,this.y2=i}var t=e.prototype;return t.render=function(){this.p5.strokeWeight(1.5),this.p5.stroke("#00ccff"),this.isDungeonEntrance?this.p5.fill("#0066aa"):this.isDungeonExit?this.p5.fill("#002244"):this.p5.fill("#004466"),this.p5.beginShape(),this.p5.vertex(this.x1,this.y1),this.p5.vertex(this.x2,this.y1),this.p5.vertex(this.x2,this.y2),this.p5.vertex(this.x1,this.y2),this.p5.vertex(this.x1,this.y1),this.p5.endShape(),this.renderText(),this.exits.forEach((function(e){return e.render()}))},t.renderText=function(){this.p5.noStroke(),this.hasKey&&(this.p5.fill("#00ccff"),this.p5.textSize(19),this.p5.textAlign(this.p5.CENTER,this.p5.CENTER),this.hasKey?(this.p5.translate(this.x1+(this.x2-this.x1)/2,this.y1+(this.y2-this.y1)/2),this.p5.rotate(3*this.p5.PI/4),this.p5.text("F",1,-5),this.p5.text("O",-1,7),this.p5.resetMatrix()):this.p5.text(this.level,this.x1+(this.x2-this.x1)/2,this.y1+(this.y2-this.y1)/2))},t.isNeighbor=function(e){return this.y1===e.y2+8&&e.x2-this.x1>48&&this.x2-e.x1>48?"north":this.x2===e.x1-8&&e.y2-this.y1>48&&this.y2-e.y1>48?"east":this.y2===e.y1-8&&e.x2-this.x1>48&&this.x2-e.x1>48?"south":this.x1===e.x2+8&&e.y2-this.y1>48&&this.y2-e.y1>48?"west":void 0},t.findExits=function(e){var t=this;return 0===e.length?this.level:(e.forEach((function(e){if(!(!t.isNeighbor(e)||e.entrance||Math.random()>.85)){var n=new L(t.p5,t,e);t.exits.push(n),e.entrance=n,e.level=t.level+1}})),this.maxLevel=this.level,this.exits.forEach((function(n){var r=n.to.findExits(e);r>t.maxLevel&&(t.maxLevel=r)})),this.maxLevel)},t.findDungeonExit=function(){if(this.isDungeonEntrance){var e=this.findMaxLevelDescendent();return e.isDungeonExit=!0,e}},t.findMaxLevelDescendent=function(){if(0===this.exits.length)return this;var e=this.exits[0].to;return this.exits.forEach((function(t){var n=t.to;n.maxLevel>e.maxLevel&&(e=n)})),e.findMaxLevelDescendent()},t.findPath=function(){if(this.isDungeonExit)for(var e=this.entrance;e;)e.onPath=!0,e.from.onPath=!0,e=e.from.entrance},t.findNonPathExit=function(){var e;return this.exits.forEach((function(t){t.onPath||(!e||t.to.maxLevel>e.to.maxLevel)&&(e=t)})),e},t.findPathExit=function(){return this.exits.find((function(e){return e.onPath}))},t.placeKey=function(){var e;if(!this.isDungeonExit)return!1;for(var t=this,n=Math.floor(D(1,this.level));n>0&&null!==(r=t)&&void 0!==r&&r.entrance;n--){var r,i,o;t=null===(i=t)||void 0===i||null===(o=i.entrance)||void 0===o?void 0:o.from}for(var s=void 0;!s;){var a;if(!(s=null===(a=t)||void 0===a?void 0:a.findNonPathExit())){var c;if(null===(c=t)||void 0===c||!c.entrance)return!1;t=t.entrance.from}}var h=null===(e=t)||void 0===e?void 0:e.findPathExit();return!!h&&(h.isLocked=!0,s.to.findMaxLevelDescendent().hasKey=!0,!0)},e}(),L=function(){function e(e,t,n){switch(this.onPath=!1,this.isLocked=!1,this.isVertical=!1,this.p5=e,this.from=t,this.to=n,t.isNeighbor(n)){case"north":this.isVertical=!1,this.y1=t.y1-8,this.y2=t.y1;break;case"east":this.isVertical=!0,this.x1=t.x2,this.x2=t.x2+8;break;case"south":this.isVertical=!1,this.y1=t.y2,this.y2=t.y2+8;break;case"west":this.isVertical=!0,this.x1=t.x1-8,this.x2=t.x1}if(this.isVertical){var r=Math.max(t.y1,n.y1),i=Math.min(t.y2,n.y2),o=8*Math.floor(D(r+12+8,i-12-8)/8);this.y1=o-12,this.y2=o+12}else{var s=Math.max(t.x1,n.x1),a=Math.min(t.x2,n.x2),c=8*Math.floor(D(s+12+8,a-12-8)/8);this.x1=c-12,this.x2=c+12}}return e.prototype.render=function(){if(this.to.render(),this.p5.noStroke(),this.p5.fill("#004466"),this.isVertical?(this.p5.beginShape(),this.p5.vertex(this.x1-2,this.y1),this.p5.vertex(this.x2+2,this.y1),this.p5.vertex(this.x2+2,this.y2),this.p5.vertex(this.x1-2,this.y2),this.p5.endShape()):(this.p5.beginShape(),this.p5.vertex(this.x1,this.y1-2),this.p5.vertex(this.x2,this.y1-2),this.p5.vertex(this.x2,this.y2+2),this.p5.vertex(this.x1,this.y2+2),this.p5.endShape()),this.p5.stroke("#00ccff"),this.p5.strokeWeight(1.5),this.isVertical?(this.p5.line(this.x1,this.y1,this.x2,this.y1),this.p5.line(this.x1,this.y2,this.x2,this.y2)):(this.p5.line(this.x1,this.y1,this.x1,this.y2),this.p5.line(this.x2,this.y1,this.x2,this.y2)),this.isLocked)if(this.p5.stroke("#00ccff"),this.p5.strokeWeight(4),this.isVertical){var e=(this.x1+this.x2)/2;this.p5.line(e,this.y1+2,e,this.y2-2)}else{var t=(this.y1+this.y2)/2;this.p5.line(this.x1+2,t,this.x2-2,t)}},e}(),$=function(){function e(e){this.maxLevel=0,this.p5=e}var t=e.prototype;return t.generateDungeon=function(){var e,t=this.divide(5);this.dungeonEntrance=t[0],this.dungeonEntrance.isDungeonEntrance=!0,this.maxLevel=this.dungeonEntrance.findExits(t.slice(1)),this.dungeonExit=this.dungeonEntrance.findDungeonExit(),null===(e=this.dungeonExit)||void 0===e||e.findPath();for(var n=Math.floor(D(1,4)),r=0;r<n;r++){var i;null===(i=this.dungeonExit)||void 0===i||i.placeKey()}},t.renderDungeon=function(){var e;this.p5.background(0),null===(e=this.dungeonEntrance)||void 0===e||e.render()},t.divide=function(e,t,n){if(!t||!n)return this.divide(e,new M(this.p5,8,this.p5.width-8,8,this.p5.height-8),[]);if(0===e)return[].concat(Object(O.a)(n),[t]);var r=e%2==0;if(Math.random()>.85?r:!r){var i=N(t.x1,t.x2);return t.x2-(i+8)<48||i-t.x1<48?this.divide(e-1,t,n):[].concat(Object(O.a)(this.divide(e-1,new M(this.p5,t.x1,i,t.y1,t.y2),n)),Object(O.a)(this.divide(e-1,new M(this.p5,i+8,t.x2,t.y1,t.y2),n)))}var o=N(t.y1,t.y2);return t.y2-(o+8)<48||o-t.y1<48?this.divide(e-1,t,n):[].concat(Object(O.a)(this.divide(e-1,new M(this.p5,t.x1,t.x2,t.y1,o),n)),Object(O.a)(this.divide(e-1,new M(this.p5,t.x1,t.x2,o+8,t.y2),n)))},e}(),_=function(e){return function(t){var n,r=new $(t),i=Math.min(document.body.clientWidth-100,700),o=i<662?4*i/3:3*i/4;t.setup=function(){t.createCanvas(i,o),t.noStroke(),r.generateDungeon(),r.renderDungeon()},null===(n=e.current)||void 0===n||n.addEventListener("click",(function(e){e.preventDefault(),r.generateDungeon(),r.renderDungeon()}))}},R=n("ky/i"),j=n.n(R),T=n("eqM9"),V=n.n(T),A=Object(r.forwardRef)((function(e,t){var n=e.children,r=Object(s.a)(e,["children"]);return i.a.createElement("button",Object.assign({ref:t,type:"button"},r,{className:V.a.button}),n)}));t.default=function(){var e=Object(r.useRef)(null);return i.a.createElement(o.a,{title:"Dungeon Generator"},i.a.createElement("div",{className:j.a.content},i.a.createElement("h1",null,"Dungeon Generator"),"A dungeon created using procedural generation. Start from the light blue room and try to navigate to the dark blue room. If a locked door blocks your path, find a key to open it.",i.a.createElement("div",{className:j.a.legend},i.a.createElement("div",null,i.a.createElement("span",{className:j.a.swatch,style:{background:"#0066aa"}})," Entrance"),i.a.createElement("div",null,i.a.createElement("span",{className:j.a.swatch,style:{background:"#002244"}})," Exit"),i.a.createElement("div",null,i.a.createElement("img",{className:j.a.swatch,src:"/images/dungeon_lock.png"})," Locked door"),i.a.createElement("div",null,i.a.createElement("img",{className:j.a.swatch,src:"/images/dungeon_key.png"})," Key")),i.a.createElement("h2",null,"Demo"),i.a.createElement("div",{className:j.a.simulation},i.a.createElement(C,{sketch:_(e)})),i.a.createElement(A,{ref:e},"Generate a new dungeon"),i.a.createElement("h2",null,"How it works"),i.a.createElement("h3",null,"Generating rooms"),"The algorithm starts with a single large room. It chooses a random point and adds a wall to split the room into two new rooms. It repeats this process with each room until the dungeon is sufficiently complex.",i.a.createElement("div",{className:j.a.rooms},i.a.createElement("img",{src:"/images/dungeon_0.png"}),i.a.createElement("img",{src:"/images/dungeon_1.png"}),i.a.createElement("img",{src:"/images/dungeon_2.png"}),i.a.createElement("img",{src:"/images/dungeon_3.png"})),i.a.createElement("h3",null,"Adding doors"),"Next, the algorithm chooses a room to be the entrance. It creates a door to each neighbor at a random point along the shared wall. For each newly connected room, the process is repeated. The result is a tree structure of rooms starting from the dungeon entrance.",i.a.createElement("h3",null,"Choosing an exit"),"The dungeon exit is chosen to be the room at the greatest depth, that is the furthest number of doors from the dungeon entrance. There is only one path from the entrance to the exit.",i.a.createElement("h3",null,"Placing keys & locks"),"The dungeon will have between one and four locked doors, each along the direct path from the entrance to the exit. For each locked door, a key is placed in a room further up the tree."))}},TOwV:function(e,t,n){"use strict";e.exports=n("qT12")},eqM9:function(e,t,n){e.exports={button:"button-module--button--1AP7e"}},"ky/i":function(e,t,n){e.exports={content:"dungeon-module--content--1CRg0",legend:"dungeon-module--legend--2XZJ5",swatch:"dungeon-module--swatch--3B54k",rooms:"dungeon-module--rooms--2XZ_V",simulation:"dungeon-module--simulation--2cPEP"}},qT12:function(e,t,n){"use strict";var r="function"==typeof Symbol&&Symbol.for,i=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,s=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,h=r?Symbol.for("react.provider"):60109,l=r?Symbol.for("react.context"):60110,u=r?Symbol.for("react.async_mode"):60111,f=r?Symbol.for("react.concurrent_mode"):60111,d=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,y=r?Symbol.for("react.suspense_list"):60120,m=r?Symbol.for("react.memo"):60115,v=r?Symbol.for("react.lazy"):60116,x=r?Symbol.for("react.block"):60121,g=r?Symbol.for("react.fundamental"):60117,b=r?Symbol.for("react.responder"):60118,E=r?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case u:case f:case s:case c:case a:case p:return e;default:switch(e=e&&e.$$typeof){case l:case d:case v:case m:case h:return e;default:return t}}case o:return t}}}function k(e){return w(e)===f}t.AsyncMode=u,t.ConcurrentMode=f,t.ContextConsumer=l,t.ContextProvider=h,t.Element=i,t.ForwardRef=d,t.Fragment=s,t.Lazy=v,t.Memo=m,t.Portal=o,t.Profiler=c,t.StrictMode=a,t.Suspense=p,t.isAsyncMode=function(e){return k(e)||w(e)===u},t.isConcurrentMode=k,t.isContextConsumer=function(e){return w(e)===l},t.isContextProvider=function(e){return w(e)===h},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return w(e)===d},t.isFragment=function(e){return w(e)===s},t.isLazy=function(e){return w(e)===v},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===c},t.isStrictMode=function(e){return w(e)===a},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===f||e===c||e===a||e===p||e===y||"object"==typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===m||e.$$typeof===h||e.$$typeof===l||e.$$typeof===d||e.$$typeof===g||e.$$typeof===b||e.$$typeof===E||e.$$typeof===x)},t.typeOf=w},zLVn:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=component---src-pages-projects-simulations-procedural-dungeon-tsx-9193ef2c61c51a67f939.js.map